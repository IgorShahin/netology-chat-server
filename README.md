# Сетевой чат — сервер

Курсовой проект по Java: реализация серверной части консольного сетевого чата.

Сервер принимает подключения от клиентов по TCP, пересылает сообщения между ними и пишет все события в лог-файл `file.log`.

## Возможности сервера

- Чтение номера порта из файла настроек `settings.txt`;
- Ожидание подключений от нескольких клиентов одновременно;
- Присоединение клиентов к чату в любой момент времени;
- Рассылка сообщений от одного клиента всем остальным;
- Логирование всех сообщений, проходящих через сервер, с указанием:
    - времени отправки,
    - имени пользователя,
    - текста сообщения.

## Архитектура

### Потоки и ответственность

Сервер построен по классической модели «один поток на клиента»:

- **Главный поток сервера**:
    - создаёт `ServerSocket`;
    - ждёт подключения в цикле (`accept()`);
    - для каждого нового клиента создаёт экземпляр `ClientHandler` и запускает его в отдельном потоке;
    - хранит список активных клиентов и отвечает за рассылку сообщений (broadcast).

- **Поток клиента (`ClientHandler`)**:
    - читает строки из сокета клиента;
    - десериализует их в объект `Message`;
    - в зависимости от типа сообщения:
        - обрабатывает подключение пользователя (JOIN),
        - пересылает текстовые сообщения через сервер (MESSAGE),
        - выполняет корректный выход из чата (EXIT);
    - при отключении очищает ресурсы и удаляет себя из списка клиентов сервера.

Таким образом сервер одновременно:
- продолжает слушать новые подключения,
- обрабатывает входящие сообщения от уже подключённых клиентов.

### Протокол обмена сообщениями

Для обмена данными используется простой текстовый протокол поверх TCP.  
Сообщение представлено классом `Message`:

- `MessageType type` — тип сообщения:
    - `JOIN` — пользователь вошёл в чат;
    - `MESSAGE` — обычное текстовое сообщение;
    - `EXIT` — выход пользователя;
    - `SYSTEM` — системное сообщение сервера.
- `String username` — имя пользователя;
- `String content` — текст сообщения.